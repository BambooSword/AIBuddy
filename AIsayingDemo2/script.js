// 多语言支持
const i18n = {
    zh: {
        app_title: '智能翻译助手',
        input_text: '输入文本',
        input_placeholder: '请输入要翻译的文本，或点击麦克风进行语音输入...',
        translate: '翻译',
        translation_result: '翻译结果',
        result_placeholder: '翻译结果将在这里显示',
        history: '历史记录',
        favorites: '收藏夹',
        settings: '设置',
        interface_language: '界面语言',
        select_language: '选择语言',
        translation_settings: '翻译设置',
        auto_translate: '自动翻译',
        save_history: '保存历史记录',
        voice_settings: '语音设置',
        voice_speed: '语音速度',
        auto_play: '自动播放翻译结果',
        appearance: '外观',
        theme: '主题',
        light_theme: '浅色主题',
        dark_theme: '深色主题',
        auto_theme: '跟随系统',
        save: '保存',
        reset: '重置',
        recording: '正在录音...',
        please_input_text: '请输入要翻译的文本',
        translation_complete: '翻译完成',
        voice_recognition_failed: '语音识别失败，请重试',
        browser_not_support_voice: '您的浏览器不支持语音识别功能',
        no_playable_result: '没有可播放的翻译结果',
        added_to_favorites: '已添加到收藏',
        removed_from_favorites: '已从收藏中移除',
        no_favorite_result: '没有可收藏的翻译结果',
        result_copied: '翻译结果已复制到剪贴板',
        copy_failed: '复制失败，请手动复制',
        no_copy_result: '没有可复制的翻译结果',
        browser_not_support_speech: '您的浏览器不支持语音合成功能',
        deleted_from_favorites: '已从收藏中删除',
        settings_saved: '设置已保存',
        settings_reset: '设置已重置'
    },
    en: {
        app_title: 'Smart Translator',
        input_text: 'Input Text',
        input_placeholder: 'Enter text to translate, or click microphone for voice input...',
        translate: 'Translate',
        translation_result: 'Translation Result',
        result_placeholder: 'Translation result will appear here',
        history: 'History',
        favorites: 'Favorites',
        settings: 'Settings',
        interface_language: 'Interface Language',
        select_language: 'Select Language',
        translation_settings: 'Translation Settings',
        auto_translate: 'Auto Translate',
        save_history: 'Save History',
        voice_settings: 'Voice Settings',
        voice_speed: 'Voice Speed',
        auto_play: 'Auto Play Translation',
        appearance: 'Appearance',
        theme: 'Theme',
        light_theme: 'Light Theme',
        dark_theme: 'Dark Theme',
        auto_theme: 'Follow System',
        save: 'Save',
        reset: 'Reset',
        recording: 'Recording...',
        please_input_text: 'Please enter text to translate',
        translation_complete: 'Translation complete',
        voice_recognition_failed: 'Voice recognition failed, please try again',
        browser_not_support_voice: 'Your browser does not support voice recognition',
        no_playable_result: 'No playable translation result',
        added_to_favorites: 'Added to favorites',
        removed_from_favorites: 'Removed from favorites',
        no_favorite_result: 'No favorite translation result',
        result_copied: 'Translation result copied to clipboard',
        copy_failed: 'Copy failed, please copy manually',
        no_copy_result: 'No copyable translation result',
        browser_not_support_speech: 'Your browser does not support speech synthesis',
        deleted_from_favorites: 'Deleted from favorites',
        settings_saved: 'Settings saved',
        settings_reset: 'Settings reset'
    },
    cantonese: {
        app_title: '智能翻譯助手',
        input_text: '輸入文本',
        input_placeholder: '請輸入要翻譯的文本，或點擊麥克風進行語音輸入...',
        translate: '翻譯',
        translation_result: '翻譯結果',
        result_placeholder: '翻譯結果將在這裡顯示',
        history: '歷史記錄',
        favorites: '收藏夾',
        settings: '設置',
        interface_language: '界面語言',
        select_language: '選擇語言',
        translation_settings: '翻譯設置',
        auto_translate: '自動翻譯',
        save_history: '保存歷史記錄',
        voice_settings: '語音設置',
        voice_speed: '語音速度',
        auto_play: '自動播放翻譯結果',
        appearance: '外觀',
        theme: '主題',
        light_theme: '淺色主題',
        dark_theme: '深色主題',
        auto_theme: '跟隨系統',
        save: '保存',
        reset: '重置',
        recording: '正在錄音...',
        please_input_text: '請輸入要翻譯的文本',
        translation_complete: '翻譯完成',
        voice_recognition_failed: '語音識別失敗，請重試',
        browser_not_support_voice: '您的瀏覽器不支持語音識別功能',
        no_playable_result: '沒有可播放的翻譯結果',
        added_to_favorites: '已添加到收藏',
        removed_from_favorites: '已從收藏中移除',
        no_favorite_result: '沒有可收藏的翻譯結果',
        result_copied: '翻譯結果已複製到剪貼板',
        copy_failed: '複製失敗，請手動複製',
        no_copy_result: '沒有可複製的翻譯結果',
        browser_not_support_speech: '您的瀏覽器不支持語音合成功能',
        deleted_from_favorites: '已從收藏中刪除',
        settings_saved: '設置已保存',
        settings_reset: '設置已重置'
    },
    arabic: {
        app_title: 'المترجم الذكي',
        input_text: 'نص الإدخال',
        input_placeholder: 'أدخل النص للترجمة، أو انقر على الميكروفون للإدخال الصوتي...',
        translate: 'ترجمة',
        translation_result: 'نتيجة الترجمة',
        result_placeholder: 'ستظهر نتيجة الترجمة هنا',
        history: 'السجل',
        favorites: 'المفضلة',
        settings: 'الإعدادات',
        interface_language: 'لغة الواجهة',
        select_language: 'اختر اللغة',
        translation_settings: 'إعدادات الترجمة',
        auto_translate: 'ترجمة تلقائية',
        save_history: 'حفظ السجل',
        voice_settings: 'إعدادات الصوت',
        voice_speed: 'سرعة الصوت',
        auto_play: 'تشغيل الترجمة تلقائياً',
        appearance: 'المظهر',
        theme: 'المظهر',
        light_theme: 'المظهر الفاتح',
        dark_theme: 'المظهر الداكن',
        auto_theme: 'اتباع النظام',
        save: 'حفظ',
        reset: 'إعادة تعيين',
        recording: 'جاري التسجيل...',
        please_input_text: 'يرجى إدخال نص للترجمة',
        translation_complete: 'اكتملت الترجمة',
        voice_recognition_failed: 'فشل التعرف على الصوت، يرجى المحاولة مرة أخرى',
        browser_not_support_voice: 'متصفحك لا يدعم التعرف على الصوت',
        no_playable_result: 'لا توجد نتيجة ترجمة قابلة للتشغيل',
        added_to_favorites: 'تمت الإضافة إلى المفضلة',
        removed_from_favorites: 'تمت الإزالة من المفضلة',
        no_favorite_result: 'لا توجد نتيجة ترجمة للمفضلة',
        result_copied: 'تم نسخ نتيجة الترجمة إلى الحافظة',
        copy_failed: 'فشل النسخ، يرجى النسخ يدوياً',
        no_copy_result: 'لا توجد نتيجة قابلة للنسخ',
        browser_not_support_speech: 'متصفحك لا يدعم توليد الكلام',
        deleted_from_favorites: 'تم الحذف من المفضلة',
        settings_saved: 'تم حفظ الإعدادات',
        settings_reset: 'تم إعادة تعيين الإعدادات'
    }
};

// 当前语言
let currentLanguage = 'zh';

// DOM 元素
const inputText = document.getElementById('inputText');
const resultContent = document.getElementById('resultContent');
const charCount = document.querySelector('.char-count');
const translateBtn = document.getElementById('translateBtn');
const voiceInput = document.getElementById('voiceInput');
const clearInput = document.getElementById('clearInput');
const playResult = document.getElementById('playResult');
const favoriteBtn = document.getElementById('favoriteBtn');
const copyResult = document.getElementById('copyResult');
const swapLang = document.getElementById('swapLang');
const sourceLang = document.getElementById('sourceLang');
const targetLang = document.getElementById('targetLang');
const voiceIndicator = document.getElementById('voiceIndicator');
const tabBtns = document.querySelectorAll('.tab-btn');
const tabPanels = document.querySelectorAll('.tab-panel');
const settingsBtn = document.getElementById('settingsBtn');
const settingsOverlay = document.getElementById('settingsOverlay');
const closeSettings = document.getElementById('closeSettings');
const saveSettings = document.getElementById('saveSettings');
const resetSettings = document.getElementById('resetSettings');
const interfaceLang = document.getElementById('interfaceLang');

// 设置相关元素
const autoTranslate = document.getElementById('autoTranslate');
const saveHistory = document.getElementById('saveHistory');
const voiceSpeed = document.getElementById('voiceSpeed');
const voiceSpeedValue = document.getElementById('voiceSpeedValue');
const autoPlay = document.getElementById('autoPlay');
const theme = document.getElementById('theme');

// 初始化设置
let settings = {
    interfaceLanguage: 'zh',
    autoTranslate: false,
    saveHistory: true,
    voiceSpeed: 0.8,
    autoPlay: false,
    theme: 'light'
};

// 多语言切换函数
function changeLanguage(lang) {
    currentLanguage = lang;
    document.documentElement.lang = lang;
    
    // 更新所有带有 data-i18n 属性的元素
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (i18n[lang] && i18n[lang][key]) {
            element.textContent = i18n[lang][key];
        }
    });
    
    // 更新占位符文本
    document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        if (i18n[lang] && i18n[lang][key]) {
            element.placeholder = i18n[lang][key];
        }
    });
}

// 字符计数功能
inputText.addEventListener('input', function() {
    const count = this.value.length;
    charCount.textContent = `${count}/500`;
    
    if (count > 450) {
        charCount.style.color = '#e53e3e';
    } else if (count > 400) {
        charCount.style.color = '#ed8936';
    } else {
        charCount.style.color = '#718096';
    }
});

// 翻译功能
function translateText() {
    const text = inputText.value.trim();
    if (!text) {
        showNotification(i18n[currentLanguage].please_input_text || '请输入要翻译的文本', 'warning');
        return;
    }
    
    translateBtn.disabled = true;
    translateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ' + (i18n[currentLanguage].translate || '翻译');
    
    setTimeout(() => {
        const mockResults = {
            'zh-en': {
                '你好': 'Hello',
                '谢谢': 'Thank you',
                '再见': 'Goodbye',
                '今天天气很好': 'The weather is nice today'
            },
            'en-zh': {
                'hello': '你好',
                'thank you': '谢谢',
                'goodbye': '再见',
                'the weather is nice today': '今天天气很好'
            }
        };
        
        const source = sourceLang.value;
        const target = targetLang.value;
        const key = `${source}-${target}`;
        
        let result = mockResults[key]?.[text.toLowerCase()] || `[${text}] 的翻译结果`;
        
        resultContent.innerHTML = `
            <div style="width: 100%;">
                <div style="font-size: 16px; line-height: 1.6; color: #2d3748;">
                    ${result}
                </div>
            </div>
        `;
        
        translateBtn.disabled = false;
        translateBtn.innerHTML = '<i class="fas fa-language"></i> ' + (i18n[currentLanguage].translate || '翻译');
        
        if (settings.saveHistory) {
            addToHistory(text, result);
        }
        
        showNotification(i18n[currentLanguage].translation_complete || '翻译完成', 'success');
    }, 1500);
}

// 翻译按钮点击事件
translateBtn.addEventListener('click', translateText);

// 语音输入功能
voiceInput.addEventListener('click', function() {
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();
        
        recognition.lang = getLanguageCode(sourceLang.value);
        recognition.continuous = false;
        recognition.interimResults = false;
        
        voiceIndicator.classList.add('active');
        
        recognition.onresult = function(event) {
            const transcript = event.results[0][0].transcript;
            inputText.value = transcript;
            inputText.dispatchEvent(new Event('input'));
        };
        
        recognition.onerror = function(event) {
            showNotification(i18n[currentLanguage].voice_recognition_failed || '语音识别失败，请重试', 'error');
        };
        
        recognition.onend = function() {
            voiceIndicator.classList.remove('active');
        };
        
        recognition.start();
    } else {
        showNotification(i18n[currentLanguage].browser_not_support_voice || '您的浏览器不支持语音识别功能', 'error');
    }
});

// 清除输入
clearInput.addEventListener('click', function() {
    inputText.value = '';
    inputText.dispatchEvent(new Event('input'));
    resultContent.innerHTML = `
        <div class="placeholder-text">
            <i class="fas fa-arrow-right"></i>
            <p>${i18n[currentLanguage].result_placeholder || '翻译结果将在这里显示'}</p>
        </div>
    `;
});

// 播放翻译结果
playResult.addEventListener('click', function() {
    const resultText = resultContent.textContent.trim();
    if (resultText && resultText !== (i18n[currentLanguage].result_placeholder || '翻译结果将在这里显示')) {
        speakText(resultText, targetLang.value);
    } else {
        showNotification(i18n[currentLanguage].no_playable_result || '没有可播放的翻译结果', 'warning');
    }
});

// 收藏功能
favoriteBtn.addEventListener('click', function() {
    const sourceText = inputText.value.trim();
    const targetText = resultContent.textContent.trim();
    
    if (sourceText && targetText && targetText !== (i18n[currentLanguage].result_placeholder || '翻译结果将在这里显示')) {
        const icon = this.querySelector('i');
        if (icon.classList.contains('far')) {
            icon.classList.remove('far');
            icon.classList.add('fas');
            addToFavorites(sourceText, targetText);
            showNotification(i18n[currentLanguage].added_to_favorites || '已添加到收藏', 'success');
        } else {
            icon.classList.remove('fas');
            icon.classList.add('far');
            removeFromFavorites(sourceText);
            showNotification(i18n[currentLanguage].removed_from_favorites || '已从收藏中移除', 'info');
        }
    } else {
        showNotification(i18n[currentLanguage].no_favorite_result || '没有可收藏的翻译结果', 'warning');
    }
});

// 复制功能
copyResult.addEventListener('click', function() {
    const resultText = resultContent.textContent.trim();
    if (resultText && resultText !== (i18n[currentLanguage].result_placeholder || '翻译结果将在这里显示')) {
        navigator.clipboard.writeText(resultText).then(() => {
            showNotification(i18n[currentLanguage].result_copied || '翻译结果已复制到剪贴板', 'success');
        }).catch(() => {
            showNotification(i18n[currentLanguage].copy_failed || '复制失败，请手动复制', 'error');
        });
    } else {
        showNotification(i18n[currentLanguage].no_copy_result || '没有可复制的翻译结果', 'warning');
    }
});

// 语言切换
swapLang.addEventListener('click', function() {
    const temp = sourceLang.value;
    sourceLang.value = targetLang.value;
    targetLang.value = temp;
    
    resultContent.innerHTML = `
        <div class="placeholder-text">
            <i class="fas fa-arrow-right"></i>
            <p>${i18n[currentLanguage].result_placeholder || '翻译结果将在这里显示'}</p>
        </div>
    `;
});

// 设置面板功能
settingsBtn.addEventListener('click', function() {
    settingsOverlay.classList.add('active');
    loadSettings();
});

closeSettings.addEventListener('click', function() {
    settingsOverlay.classList.remove('active');
});

settingsOverlay.addEventListener('click', function(e) {
    if (e.target === settingsOverlay) {
        settingsOverlay.classList.remove('active');
    }
});

// 保存设置
saveSettings.addEventListener('click', function() {
    settings.interfaceLanguage = interfaceLang.value;
    settings.autoTranslate = autoTranslate.checked;
    settings.saveHistory = saveHistory.checked;
    settings.voiceSpeed = parseFloat(voiceSpeed.value);
    settings.autoPlay = autoPlay.checked;
    settings.theme = theme.value;
    
    localStorage.setItem('translatorSettings', JSON.stringify(settings));
    
    if (settings.interfaceLanguage !== currentLanguage) {
        changeLanguage(settings.interfaceLanguage);
    }
    
    settingsOverlay.classList.remove('active');
    showNotification(i18n[currentLanguage].settings_saved || '设置已保存', 'success');
});

// 重置设置
resetSettings.addEventListener('click', function() {
    settings = {
        interfaceLanguage: 'zh',
        autoTranslate: false,
        saveHistory: true,
        voiceSpeed: 0.8,
        autoPlay: false,
        theme: 'light'
    };
    
    interfaceLang.value = settings.interfaceLanguage;
    autoTranslate.checked = settings.autoTranslate;
    saveHistory.checked = settings.saveHistory;
    voiceSpeed.value = settings.voiceSpeed;
    voiceSpeedValue.textContent = settings.voiceSpeed;
    autoPlay.checked = settings.autoPlay;
    theme.value = settings.theme;
    
    localStorage.setItem('translatorSettings', JSON.stringify(settings));
    
    showNotification(i18n[currentLanguage].settings_reset || '设置已重置', 'info');
});

// 语音速度滑块
voiceSpeed.addEventListener('input', function() {
    voiceSpeedValue.textContent = this.value;
});

// 加载设置
function loadSettings() {
    const savedSettings = localStorage.getItem('translatorSettings');
    if (savedSettings) {
        settings = JSON.parse(savedSettings);
    }
    
    interfaceLang.value = settings.interfaceLanguage;
    autoTranslate.checked = settings.autoTranslate;
    saveHistory.checked = settings.saveHistory;
    voiceSpeed.value = settings.voiceSpeed;
    voiceSpeedValue.textContent = settings.voiceSpeed;
    autoPlay.checked = settings.autoPlay;
    theme.value = settings.theme;
}

// 标签页切换
tabBtns.forEach(btn => {
    btn.addEventListener('click', function() {
        const targetTab = this.dataset.tab;
        
        tabBtns.forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        tabPanels.forEach(panel => {
            panel.classList.remove('active');
            if (panel.id === `${targetTab}Panel`) {
                panel.classList.add('active');
            }
        });
    });
});

// 历史记录播放
document.addEventListener('click', function(e) {
    if (e.target.closest('.history-play')) {
        const item = e.target.closest('.history-item');
        const text = item.querySelector('.target-text').textContent;
        speakText(text, targetLang.value);
    }
});

// 历史记录收藏
document.addEventListener('click', function(e) {
    if (e.target.closest('.history-favorite')) {
        const item = e.target.closest('.history-item');
        const sourceText = item.querySelector('.source-text').textContent;
        const targetText = item.querySelector('.target-text').textContent;
        const btn = e.target.closest('.history-favorite');
        const icon = btn.querySelector('i');
        
        if (icon.classList.contains('far')) {
            icon.classList.remove('far');
            icon.classList.add('fas');
            addToFavorites(sourceText, targetText);
            showNotification(i18n[currentLanguage].added_to_favorites || '已添加到收藏', 'success');
        } else {
            icon.classList.remove('fas');
            icon.classList.add('far');
            removeFromFavorites(sourceText);
            showNotification(i18n[currentLanguage].removed_from_favorites || '已从收藏中移除', 'info');
        }
    }
});

// 收藏夹播放
document.addEventListener('click', function(e) {
    if (e.target.closest('.favorite-play')) {
        const item = e.target.closest('.favorite-item');
        const text = item.querySelector('.target-text').textContent;
        speakText(text, targetLang.value);
    }
});

// 收藏夹删除
document.addEventListener('click', function(e) {
    if (e.target.closest('.favorite-remove')) {
        const item = e.target.closest('.favorite-item');
        const sourceText = item.querySelector('.source-text').textContent;
        item.remove();
        removeFromFavorites(sourceText);
        showNotification(i18n[currentLanguage].deleted_from_favorites || '已从收藏中删除', 'info');
    }
});

// 辅助函数
function getLanguageCode(lang) {
    const codes = {
        'zh': 'zh-CN',
        'en': 'en-US',
        'cantonese': 'zh-HK',
        'arabic': 'ar-SA'
    };
    return codes[lang] || 'zh-CN';
}

function speakText(text, lang) {
    if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = getLanguageCode(lang);
        utterance.rate = settings.voiceSpeed;
        speechSynthesis.speak(utterance);
    } else {
        showNotification(i18n[currentLanguage].browser_not_support_speech || '您的浏览器不支持语音合成功能', 'error');
    }
}

function addToHistory(sourceText, targetText) {
    const historyList = document.getElementById('historyList');
    const historyItem = document.createElement('div');
    historyItem.className = 'history-item';
    historyItem.innerHTML = `
        <div class="history-text">
            <div class="source-text">${sourceText}</div>
            <div class="target-text">${targetText}</div>
        </div>
        <div class="history-actions">
            <button class="history-play" title="播放">
                <i class="fas fa-volume-up"></i>
            </button>
            <button class="history-favorite" title="收藏">
                <i class="far fa-heart"></i>
            </button>
        </div>
    `;
    
    historyList.insertBefore(historyItem, historyList.firstChild);
    
    const items = historyList.querySelectorAll('.history-item');
    if (items.length > 10) {
        historyList.removeChild(items[items.length - 1]);
    }
}

function addToFavorites(sourceText, targetText) {
    const favoritesList = document.getElementById('favoritesList');
    const favoriteItem = document.createElement('div');
    favoriteItem.className = 'favorite-item';
    favoriteItem.innerHTML = `
        <div class="favorite-text">
            <div class="source-text">${sourceText}</div>
            <div class="target-text">${targetText}</div>
        </div>
        <div class="favorite-actions">
            <button class="favorite-play" title="播放">
                <i class="fas fa-volume-up"></i>
            </button>
            <button class="favorite-remove" title="删除">
                <i class="fas fa-trash"></i>
            </button>
        </div>
    `;
    
    favoritesList.appendChild(favoriteItem);
}

function removeFromFavorites(sourceText) {
    const favoritesList = document.getElementById('favoritesList');
    const items = favoritesList.querySelectorAll('.favorite-item');
    items.forEach(item => {
        if (item.querySelector('.source-text').textContent === sourceText) {
            item.remove();
        }
    });
}

function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.innerHTML = `
        <div class="notification-content">
            <i class="fas fa-${getNotificationIcon(type)}"></i>
            <span>${message}</span>
        </div>
    `;
    
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${getNotificationColor(type)};
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        z-index: 1000;
        transform: translateX(100%);
        transition: transform 0.3s ease;
        max-width: 300px;
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.transform = 'translateX(0)';
    }, 100);
    
    setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
            document.body.removeChild(notification);
        }, 300);
    }, 3000);
}

function getNotificationIcon(type) {
    const icons = {
        'success': 'check-circle',
        'error': 'exclamation-circle',
        'warning': 'exclamation-triangle',
        'info': 'info-circle'
    };
    return icons[type] || 'info-circle';
}

function getNotificationColor(type) {
    const colors = {
        'success': '#38a169',
        'error': '#e53e3e',
        'warning': '#ed8936',
        'info': '#667eea'
    };
    return colors[type] || '#667eea';
}

// 键盘快捷键
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
        e.preventDefault();
        translateBtn.click();
    }
    
    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'C') {
        e.preventDefault();
        copyResult.click();
    }
    
    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'V') {
        e.preventDefault();
        voiceInput.click();
    }
    
    if (e.key === 'Escape' && settingsOverlay.classList.contains('active')) {
        settingsOverlay.classList.remove('active');
    }
});

// 页面加载完成后的初始化
document.addEventListener('DOMContentLoaded', function() {
    loadSettings();
    changeLanguage(settings.interfaceLanguage);
    inputText.focus();
    inputText.dispatchEvent(new Event('input'));
    
    console.log('智能翻译助手已加载完成');
}); 